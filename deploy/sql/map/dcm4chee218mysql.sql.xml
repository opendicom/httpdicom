<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
    <dict>
        
<!-- pk study + pk patient -->
        
        <!-- match study UID -->
        <key>EP4Eui</key>
        <string>%@SELECT pk,patient_fk FROM study WHERE study_iuid REGEXP '%@' %@ %@</string>
        
        <!-- match accession number -->
        <key>EP4Ean</key>
        <string>%@SELECT pk,patient_fk FROM study WHERE accession_no='%@' %@ %@</string>
        <!-- match accession number and accession issuer -->
        <key>EP4EanIei</key>
        <string>%@SELECT pk,patient_fk FROM study WHERE accession_no='%@' AND 'no_issuer' REGEXP '%@' %@ %@</string>
        <!-- match accession number and accession issuer universal and type -->
        <key>EP4EanIeiIet</key>
        <string>%@SELECT pk,patient_fk FROM study WHERE accession_no='%@' AND 'no_issuer' REGEXP '%@' AND 'no_issuer_type' REGEXP '%@' %@ %@</string>



        <!-- match Pid + Eda (empty) = any -->
        <key>EP4PidEda0</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' %@ %@</string>
        
        <!-- match Pid + Eda [aaaa-mm-dd] = on -->
        <key>EP4PidEda1</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND DATE(study.study_datetime) = '%@' %@ %@</string>
        
        <!-- match Pid + Eda [aaaa-mm-dd][] = since -->
        <key>EP4PidEda2</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND DATE(study.study_datetime) &gt;= '%@' %@ %@</string>
        
        <!-- match Pid + Eda [][][aaaa-mm-dd] = until -->
        <key>EP4PidEda3</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>
        
        <!-- match Pid + Eda [aaaa-mm-dd][][][aaaa-mm-dd] = between -->
        <key>EP4PidEda4</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND DATE(study.study_datetime) &gt;= '%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>



        <!-- match Pidis + Eda (empty) -> any -->
        <key>EP4PidisEda0</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND patient.pat_id_issuer = '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [aaaa-mm-dd] = on -->
        <key>EP4PidisEda1</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) = '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [aaaa-mm-dd][] = since -->
        <key>EP4PidisEda2</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) &gt;= '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [][][aaaa-mm-dd] = until -->
        <key>EP4PidisEda3</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [aaaa-mm-dd][][][aaaa-mm-dd] = between -->
        <key>EP4PidisEda4</key>
        <string>%@SELECT study.pk,study.patient_fk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id = '%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) &gt;= '%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>
        
        
                
<!-- pk study + studyInstanceUID -->
        
        <!-- match study UID -->
        <key>EuiE4Euid</key>
        <string>%@SELECT study_iuid, pk FROM study WHERE study_iuid='%@' %@ %@</string>
        
       <!-- match accession number -->
       <key>EuiE4Ean</key>
       <string>%@SELECT study_iuid, pk FROM study WHERE accession_no='%@' %@ %@</string>
       <!-- match accession number and accession issuer -->
       <key>EuiE4EanIei</key>
       <string>%@SELECT study_iuid, pk FROM study WHERE accession_no='%@' AND 'no_issuer' REGEXP '%@' %@ %@</string>
       <!-- match accession number and accession issuer universal and type -->
       <key>EuiE4EanIeiIet</key>
       <string>%@SELECT study_iuid, pk FROM study WHERE accession_no='%@' AND 'no_issuer' REGEXP '%@' AND 'no_issuer_type' REGEXP '%@' %@ %@</string>



        <!-- match Pid + Eda (empty) = any -->
       <key>EuiE4PidEda0</key>
       <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' %@ %@</string>
        
        <!-- match Pid + Eda [aaaa-mm-dd] = on -->
        <key>EuiE4PidEda1</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND DATE(study.study_datetime) = '%@' %@ %@</string>
        
        <!-- match Pid + Eda [aaaa-mm-dd][] = since -->
        <key>EuiE4PidEda2</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND DATE(study.study_datetime) &gt;= '%@' %@ %@</string>
        
        <!-- match Pid + Eda [][][aaaa-mm-dd] = until -->
        <key>EuiE4PidEda3</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>
        
        <!-- match Pid + Eda [aaaa-mm-dd][][][aaaa-mm-dd] = between -->
        <key>EuiE4PidEda4</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND DATE(study.study_datetime) &gt;= '%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>
 
 
 
        
        <!-- match Pidis + Eda (empty) = any -->
        <key>EuiE4PidisEda0</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND patient.pat_id_issuer = '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [aaaa-mm-dd] = on -->
        <key>EuiE4PidisEda1</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) = '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [aaaa-mm-dd][] = since -->
        <key>EuiE4PidisEda2</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) &gt;= '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [][][aaaa-mm-dd] = until -->
        <key>EuiE4PidisEda3</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>
        
        <!-- match Pidis + Eda [aaaa-mm-dd][][][aaaa-mm-dd] = between -->
        <key>EuiE4PidisEda4</key>
        <string>%@SELECT study.study_iuid, study.pk FROM study LEFT JOIN patient ON study.patient_fk=patient.pk WHERE patient.pat_id='%@' AND patient.pat_id_issuer = '%@' AND DATE(study.study_datetime) &gt;= '%@' AND DATE(study.study_datetime) &lt;= '%@' %@ %@</string>
        




       <!-- instance ci 4 series pk -->
       <key>Ici4S</key>
       <string>%@SELECT sop_cuid FROM instance WHERE series_fk='%@' %@ %@</string>
              
       <!-- instance ui 4 series pk -->
       <key>Iui4S</key>
       <string>%@SELECT sop_iuid FROM instance WHERE series_fk='%@' %@ %@</string>

      
        
<!-- properties-->

        <!-- patient -->
        <key>P</key>
        <string>%@SELECT pk,pat_id,pat_name,pat_id_issuer,pat_birthdate,pat_sex FROM patient WHERE pk='%@' %@ %@</string>

        <!-- examen -->
        <key>E</key>
        <string>%@SELECT pk,study_iuid,study_desc,DATE(study_datetime),TIME(study_datetime),accession_no,study_id,ref_physician,num_instances,mods_in_study FROM study WHERE pk='%@' %@ %@</string>

        <!-- serie -->
        <key>S</key>
        <string>%@SELECT pk,series_iuid,series_desc,series_no,modality,institution,department,station_name,perf_physician,laterality FROM series WHERE study_fk='%@' %@ %@</string>

        <!-- instance -->
        <key>I0</key>
        <string>%@SELECT pk,sop_iuid,inst_no,0 FROM instance WHERE series_fk='%@' %@ %@</string>
        <key>I1</key>
        <string>%@SELECT pk,sop_iuid,inst_no,1 FROM instance WHERE series_fk='%@' %@ %@</string>
        <key>I</key>
        <string>%@SELECT pk,sop_iuid,inst_no,HEX(inst_attrs) FROM instance WHERE series_fk='%@' %@ %@</string>

        <key>IpostprocessingCommandsSh</key><!-- if empty, default array  -->      
        <string> | awk ' BEGIN{ ORS="\x1E\x0A"; OFS="\x1F\x7C";}{print $1, $2, $3, $4, $5}' | sed -e 's/080005004353.*280008004953....//' | sed -e 's/280010005553.*$//' | sed -e 's/20$//'</string>
        
        <key>IpostprocessingTitleMain</key>      
        <string>lastTextUnitHEX2ASCII</string>
        
    </dict>

</plist>
